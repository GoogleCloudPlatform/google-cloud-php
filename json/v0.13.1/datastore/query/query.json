{"id":"datastore\/query\/query","type":"","title":"Google\\Cloud\\Datastore\\Query\\Query","name":"Query","description":"<p>Represents a Cloud <a href=\"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries\">Datastore Query<\/a><\/p>\n<p>Queries can be created either by using the builder pattern, or by providing\na <a href=\"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#query\">Query<\/a>\nwhen creating this object.<\/p>","examples":[{"caption":"","code":"use Google\\Cloud\\ServiceBuilder;\n\n$cloud = new ServiceBuilder();\n$datastore = $cloud->datastore();\n\n$query = $datastore->query();\n$query->kind('Person');\n$query->filter('firstName', 'Bob');\n\n$result = $datastore->runQuery($query);"},{"caption":"<p>Queries can also be constructed using a Query Object:<\/p>","code":"$query = $datastore->query([\n    'query' => [\n        'kind' => [\n            [\n                'name' => 'People'\n            ]\n        ],\n        'filter' => [\n            'propertyFilter' => [\n                'op' => 'EQUAL',\n                'property' => [\n                    'name' => 'firstName'\n                ],\n                'value' => [\n                    'stringValue': 'Bob'\n                ]\n            ]\n        ]\n    ]\n]);\n\n$result = $datastore->runQuery($query);"}],"resources":[{"title":"Query Object Reference","link":"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#query"},{"title":"Datastore Queries","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries"}],"methods":[{"id":"__construct","type":"constructor","name":"__construct","source":"\/src\/Datastore\/Query\/Query.php#L137","description":"","examples":[],"resources":[],"params":[{"name":"entityMapper","description":"<p>An instance of EntityMapper<\/p>","types":["<a data-custom-type=\"datastore\/entitymapper\">Google\\Cloud\\Datastore\\EntityMapper<\/a>"],"optional":false,"nullable":null},{"name":"query","description":"<pre><code>   [Query](https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#query)<\/code><\/pre>","types":["array"],"optional":true,"nullable":null}],"exceptions":[],"returns":[]},{"id":"projection","type":"instance","name":"projection","source":"\/src\/Datastore\/Query\/Query.php#L163","description":"<p>Set the Query Projection.<\/p>\n<p>Accepts an array of properties. If set, only these properties will be\nreturned.<\/p>","examples":[{"caption":"","code":"$query->projection(['firstName', 'lastName']);"}],"resources":[],"params":[{"name":"properties","description":"<p>The property or properties to include in\nthe result.<\/p>","types":["array","string"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"keysOnly","type":"instance","name":"keysOnly","source":"\/src\/Datastore\/Query\/Query.php#L188","description":"<p>Set the query to return only keys (no properties).<\/p>","examples":[{"caption":"","code":"$query->keysOnly();"}],"resources":[],"params":[],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"kind","type":"instance","name":"kind","source":"\/src\/Datastore\/Query\/Query.php#L211","description":"<p>Set the Kind to query.<\/p>\n<p>If empty, returns entities of all kinds. Must be set in order to filter\nresults. While you may supply as many kinds as you wish, datastore currently\nonly accepts one at a time.<\/p>","examples":[{"caption":"","code":"$query->kind('Person');"}],"resources":[],"params":[{"name":"kinds","description":"<p>The kind or kinds to return. Only a single kind\nis currently supported.<\/p>","types":["array","string"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"filter","type":"instance","name":"filter","source":"\/src\/Datastore\/Query\/Query.php#L248","description":"<p>Add a filter to the query.<\/p>\n<p>If the top-level filter is specified as a propertyFilter, it will be replaced.\nAny composite filters will be preserved and the new filter will be added.<\/p>","examples":[{"caption":"","code":"$query->filter('firstName', '=', 'Bob')\n    ->filter('lastName', '=', 'Testguy');"}],"resources":[{"title":"Allowed Operators","link":"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#operator_1"}],"params":[{"name":"property","description":"<p>The property to filter.<\/p>","types":["string"],"optional":false,"nullable":null},{"name":"operator","description":"<p>The operator to use in the filter. A list of\nallowed operators may be found\n<a href=\"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#operator_1\">here<\/a>.\nShort comparison operators are provided for convenience and are\nmapped to their datastore-compatible equivalents. Available short\noperators are <code>=<\/code>, <code>&lt;<\/code>, <code>&lt;=<\/code>, <code>&gt;<\/code>, and <code>&gt;=<\/code>.<\/p>","types":["string"],"optional":false,"nullable":null},{"name":"value","description":"<p>The value to check.<\/p>","types":["mixed"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"hasAncestor","type":"instance","name":"hasAncestor","source":"\/src\/Datastore\/Query\/Query.php#L291","description":"<p>Query for entities by their ancestors.<\/p>\n<p>Keys can be provided either via a <a data-custom-type=\"datastore\/key\">Google\\Cloud\\Datastore\\Key<\/a>\nobject, or by providing a kind, identifier and (optionally) an identifier\ntype.<\/p>","examples":[{"caption":"","code":"$key = $datastore->key('Person', 'Bob');\n$query->hasAncestor($key);"},{"caption":"<p>Using a kind and indentifier<\/p>","code":"$query->hasAncestor('Person', 'Bob');"},{"caption":"<p>Specifying an identifier type<\/p>","code":"$query->hasAncestor('Robots', '1337', Key::TYPE_NAME);"}],"resources":[],"params":[{"name":"key","description":"<p>The ancestor Key instance.<\/p>","types":["<a data-custom-type=\"datastore\/key\">Google\\Cloud\\Datastore\\Key<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"order","type":"instance","name":"order","source":"\/src\/Datastore\/Query\/Query.php#L312","description":"<p>Specify an order for the query.<\/p>","examples":[{"caption":"","code":"$query->order('birthDate');"}],"resources":[{"title":"Allowed Directions","link":"https:\/\/cloud.google.com\/datastore\/reference\/rest\/v1\/projects\/runQuery#Direction"}],"params":[{"name":"property","description":"<p>The property to order by.<\/p>","types":["string"],"optional":false,"nullable":null},{"name":"direction","description":"<p>The direction to order in.<\/p>","types":["string"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"distinctOn","type":"instance","name":"distinctOn","source":"\/src\/Datastore\/Query\/Query.php#L337","description":"<p>The properties to make distinct.<\/p>\n<p>The query results will contain the first result for each distinct\ncombination of values for the given properties (if empty, all results\nare returned).<\/p>","examples":[{"caption":"","code":"$query->distinctOn('lastName');"}],"resources":[],"params":[{"name":"property","description":"<p>The property or properties to make distinct.<\/p>","types":["array","string"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"start","type":"instance","name":"start","source":"\/src\/Datastore\/Query\/Query.php#L365","description":"<p>The starting point for the query results.<\/p>","examples":[{"caption":"","code":"$query->start($lastResultCursor);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"cursor","description":"<p>The cursor on which to start the result.<\/p>","types":["string"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"end","type":"instance","name":"end","source":"\/src\/Datastore\/Query\/Query.php#L387","description":"<p>The ending point for the query results.<\/p>","examples":[{"caption":"","code":"$query->end($lastResultCursor);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"cursor","description":"<p>The cursor on which to end the result.<\/p>","types":["string"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"offset","type":"instance","name":"offset","source":"\/src\/Datastore\/Query\/Query.php#L409","description":"<p>The number of results to skip.<\/p>","examples":[{"caption":"","code":"$query->offset(2);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"num","description":"<p>The number of results to skip.<\/p>","types":["int"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]},{"id":"limit","type":"instance","name":"limit","source":"\/src\/Datastore\/Query\/Query.php#L431","description":"<p>The number of results to return.<\/p>","examples":[{"caption":"","code":"$query->limit(50);"}],"resources":[{"title":"Cursors, Limits and Offsets","link":"https:\/\/cloud.google.com\/datastore\/docs\/concepts\/queries#cursors_limits_and_offsets"}],"params":[{"name":"num","description":"<p>The number of results to return.<\/p>","types":["int"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"datastore\/query\/query\">Google\\Cloud\\Datastore\\Query\\Query<\/a>"],"description":""}]}]}